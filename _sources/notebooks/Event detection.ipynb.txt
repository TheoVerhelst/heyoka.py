{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "489ba1ac",
   "metadata": {},
   "source": [
    "# Event detection\n",
    "\n",
    "When integrating systems of ODEs, the need often arises to detect the occurrence of specific\n",
    "conditions (or *events*) in the state of the system. Many real systems, for instance, are described by equations\n",
    "that change discontinuously in response to particular conditions\n",
    "(e.g., a spacecraft entering the cone of shadow of a planet,\n",
    "or a thermostat switching on once the temperature reaches a certain level). In other situations,\n",
    "detection of specific system states may suffice (e.g., in the computation of\n",
    "[Poincar√© sections](https://en.wikipedia.org/wiki/Poincar%C3%A9_map)).\n",
    "\n",
    "An event in a system of ODEs can be defined by an *event equation* of the form \n",
    "\n",
    "$$\n",
    "g\\left( t, \\boldsymbol{x} \\left( t \\right) \\right) = 0,\n",
    "$$\n",
    "\n",
    "where, as usual, $t$ is the independent variable (time) and $\\boldsymbol{x} \\left( t \\right)$ the state vector of the system.\n",
    "As a concrete example, the collision between two spheres of radius 1 moving in a three-dimensional space can be described\n",
    "by the event equation\n",
    "\n",
    "$$\n",
    "\\left( x_1 - x_0 \\right)^2 + \\left( y_1 - y_0 \\right)^2 + \\left( z_1 - z_0 \\right)^2 - 4 = 0,\n",
    "$$\n",
    "\n",
    "where $\\left( x_0, y_0, z_0 \\right)$ and $\\left( x_1, y_1, z_1 \\right)$ are the Cartesian coordinates\n",
    "of the spheres' centres.\n",
    "\n",
    "heyoka.py features a flexible and accurate event detection framework in which the [expression system](<./The expression system.ipynb>)\n",
    "can be used to formulate arbitrary event equations. The event equations are then added to the ODE system and\n",
    "integrated together with the other equations, so that, at every timestep, a Taylor series expansion of the event equations\n",
    "in powers of time is available. Polynomial root finding techniques are then employed\n",
    "on the Taylor series of the event equations to accurately locate the time of occurrence of an event within the timestep.\n",
    "\n",
    "Like many other ODE integration libraries, heyoka.py makes a fundamental distinction between two types of events, *terminal* and *non-terminal*.\n",
    "We will begin with non-terminal events, as they are conceptually simpler.\n",
    "\n",
    "## Non-terminal events\n",
    "\n",
    "Non-terminal events are events that do not modify the state of an ODE system. That is, the occurrence of a non-terminal event does not\n",
    "change the system's dynamics and it does not alter the state vector of the system. A typical use of non-terminal events is to detect and log\n",
    "when the system reaches a particular state of interest (e.g., flagging close encounters between celestial bodies, detecting when\n",
    "a velocity or coordinate is zero, etc.).\n",
    "\n",
    "As an initial example, we will turn to our good ole friend, the simple pendulum:\n",
    "\n",
    "$$\n",
    "\\begin{cases}\n",
    "x^\\prime = v \\\\\n",
    "v^\\prime = -9.8 \\sin x\n",
    "\\end{cases}.\n",
    "$$\n",
    "\n",
    "Our goal will be to detect when the bob reaches the point of maximum amplitude, which corresponds to the angular velocity\n",
    "$v$ going to zero. In other words, out (very simple) event equation is\n",
    "\n",
    "$$\n",
    "v = 0.\n",
    "$$\n",
    "\n",
    "We begin, as usual, with the definition of the symbolic variables:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9b98f7e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import heyoka as hy\n",
    "\n",
    "x, v = hy.make_vars(\"x\", \"v\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "384fdfe3",
   "metadata": {},
   "source": [
    "Next, we create a list into which we will log the times at which $v = 0$:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5c75ac89",
   "metadata": {},
   "outputs": [],
   "source": [
    "zero_vel_times = []"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89e84aed",
   "metadata": {},
   "source": [
    "We can now proceed to create a non-terminal event:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "796e8baf",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define a callback for the event.\n",
    "def cb(ta, time, d_sgn):\n",
    "    # Compute the state of the system when the\n",
    "    # event triggered and print the value of x.\n",
    "    ta.update_d_output(time)\n",
    "    print(\"Value of x when v is zero: {}\".format(ta.d_output[0]))\n",
    "    \n",
    "    # Add the event time to zero_vel_times.\n",
    "    zero_vel_times.append(time)\n",
    "\n",
    "ev = hy.nt_event(\n",
    "        # The left-hand side of the event equation\n",
    "        v,\n",
    "        # The callback.\n",
    "        callback = cb)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a14dc1b6",
   "metadata": {},
   "source": [
    "Non-terminal events are represented in heyoka.py by the ``nt_event`` class. The first mandatory argument for the construction of a non-terminal event is the left-hand\n",
    "side of the event equation, which in this case is simply $v$.\n",
    "The second mandatory construction argument is a callback function that will be invoked when the event is detected.\n",
    "The callback function can be a lambda, a regular function, or a function object - the only requirement is that the\n",
    "callback is a callable object. The callback will be invoked with a reference to the integrator object as first argument, \n",
    "the absolute time at which the event was detected as second argument, and the sign of the derivative\n",
    "of the event equation at the trigger time as third argument (-1 for negative derivative, 1 for positive derivative and 0 for\n",
    "zero derivative).\n",
    "\n",
    "Because non-terminal event detection is performed at the end of an integration step,\n",
    "when the callback is invoked the state and time of the integrator object are those *at the end* of the integration\n",
    "step in which the event was detected. Note that when integrating an ODE system with events, the ``taylor_adaptive``\n",
    "class ensures that the Taylor coefficients are always kept up to date (as explained in the tutorial about\n",
    "[dense output](<./Dense output.ipynb>)), and thus in the callback function it is always possible to use the ``update_d_output()``\n",
    "function to compute the dense output at any time within the last timestep that was taken.\n",
    "\n",
    "In this example, we perform two actions in the callback ``cb``:\n",
    "\n",
    "- first, we compute the dense output at the event trigger time and print\n",
    "  the value of the ``x`` coordinate,\n",
    "- second, we append to ``zero_vel_times`` the trigger time.\n",
    "\n",
    "We are now ready to create our first event-detecting integrator:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3fbec49b",
   "metadata": {},
   "outputs": [],
   "source": [
    "ta = hy.taylor_adaptive(\n",
    "    # Definition of the ODE system:\n",
    "    # x' = v\n",
    "    # v' = -9.8 * sin(x)\n",
    "    ((x, v), (v, -9.8 * hy.sin(x))),\n",
    "    # Initial conditions\n",
    "    # for x and v.\n",
    "    [-0.05, 0.],\n",
    "    # Non-terminal events.\n",
    "    nt_events = [ev])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "19f41646",
   "metadata": {},
   "source": [
    "The list of non-terminal events is passed to the constructor of the\n",
    "integrator via the ``nt_events`` keyword argument. Note how we\n",
    "set up the initial conditions so that the bob is at rest at an\n",
    "angle of amplitude $0.05$.\n",
    "\n",
    "Let us now integrate for a few time units and plot the evolution of the system\n",
    "together with the times at which the event triggers:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "abfe3ecf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Value of x when v is zero: -0.05\n",
      "Value of x when v is zero: 0.049999999999999996\n",
      "Value of x when v is zero: -0.05\n",
      "Value of x when v is zero: 0.05\n",
      "Value of x when v is zero: -0.049999999999999996\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "from matplotlib.pylab import plt\n",
    "plt.rcParams[\"figure.figsize\"] = (12,6)\n",
    "\n",
    "# Construct a time grid from t=0 to t=5.\n",
    "t_grid = np.linspace(0, 5, 1000)\n",
    "\n",
    "# Propagate over the time grid.\n",
    "x_hist = ta.propagate_grid(t_grid)[4][:,0]\n",
    "\n",
    "# Display the time evolution for the x variable.\n",
    "plt.plot(t_grid, x_hist)\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"x\")\n",
    "\n",
    "# Put vertical lines in correspondence of\n",
    "# the detected events.\n",
    "for ev_time in zero_vel_times:\n",
    "    plt.axvline(x = ev_time, linestyle='--', color='gray')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e9e88e5",
   "metadata": {},
   "source": [
    "As expected, $v$ is zero at the points of maximum amplitude for the angle,\n",
    "and in these points the absolute value the $x$ angle corresponds to the\n",
    "initial amplitude of $0.05$.\n",
    "\n",
    "Let us now print the event times:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "3cd54c77",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.0, 1.003701787940065, 2.00740357588013, 3.011105363820195, 4.01480715176026]\n"
     ]
    }
   ],
   "source": [
    "print(zero_vel_times)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8765f7ce",
   "metadata": {},
   "source": [
    "We can see how the the initial condition $v_0 = 0$ immediately\n",
    "and correctly triggers an event at $t = 0$. Physically, we know that the time\n",
    "interval between the events must be half the period $T$ of the pendulum,\n",
    "which can be computed exactly via elliptic functions. With the specific\n",
    "initial conditions of this example, $T = 2.0074035758801299\\ldots$, and\n",
    "we can see from the event times printed to screen\n",
    "how the event detection system was accurate to machine precision.\n",
    "\n",
    "### Event direction\n",
    "\n",
    "By default, heyoka.py will detect all zeroes of the event equations regardless\n",
    "of the *direction* of the zero crossing (i.e., the value of the time derivative\n",
    "of the event equation at the zero). However, it is sometimes useful to trigger the detection\n",
    "of an event only if its direction is positive or negative. Event direction is represented\n",
    "in heyoka.py by the ``event_direction`` enum, whose values can be\n",
    "\n",
    "- ``event_direction.any`` (the default),\n",
    "- ``event_direction.positive`` (derivative > 0),\n",
    "- ``event_direction.negative`` (derivative < 0).\n",
    "\n",
    "Event direction can be specified upon construction:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "14e6e7b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Redefine ev to detect only events\n",
    "# in the positive direction.\n",
    "ev = hy.nt_event(\n",
    "        v, callback = lambda ta, time, d_sgn: zero_vel_times.append(time),\n",
    "        # Specify the direction.\n",
    "        direction = hy.event_direction.positive)\n",
    "\n",
    "# Reset zero_vel_times and the integrator.\n",
    "zero_vel_times.clear()\n",
    "ta = hy.taylor_adaptive(((x, v), (v, -9.8 * hy.sin(x))), [-0.05, 0.], nt_events = [ev])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "93188401",
   "metadata": {},
   "source": [
    "In this specific case, constraining the event direction to be positive is equivalent\n",
    "to detecting $v = 0$ only when the pendulum reaches the maximum amplitude on the left.\n",
    "Let us take a look at the plot:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "fcff6b83",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Propagate over the time grid.\n",
    "x_hist = ta.propagate_grid(t_grid)[4][:,0]\n",
    "\n",
    "# Display the time evolution for the x variable.\n",
    "plt.plot(t_grid, x_hist)\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"x\")\n",
    "\n",
    "# Put vertical lines in correspondence of\n",
    "# the detected events.\n",
    "for ev_time in zero_vel_times:\n",
    "    plt.axvline(x = ev_time, linestyle='--', color='gray')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e57e0720",
   "metadata": {},
   "source": [
    "Indeed, the event now triggers only 3 times (instead of 5). Let's take a loot at the event times:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "bc53abfb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.0, 2.00740357588013, 4.01480715176026]\n"
     ]
    }
   ],
   "source": [
    "print(zero_vel_times)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a83f139",
   "metadata": {},
   "source": [
    "The times confirm that the event is detected only when $v$ switches from negative to positive, i.e.,\n",
    "at $t=0$, $t=T$ and $t=2T$.\n",
    "\n",
    "### Multiple events\n",
    "\n",
    "When multiple events trigger within the same timestep (or if the same event triggers\n",
    "multiple times), heyoka.py will process the events in chronological order\n",
    "(or reverse chronological order when integrating backwards in time).\n",
    "\n",
    "Let us demonstrate this with another example with the simple pendulum.\n",
    "We will now aim to detect two events defined by the equations:\n",
    "\n",
    "$$\n",
    "\\begin{cases}\n",
    "v = 0 \\\\\n",
    "v^2 - 10^{-12} = 0\n",
    "\\end{cases}.\n",
    "$$\n",
    "\n",
    "In other words, we are looking to determine the time of maximum amplitude ($v = 0$) and\n",
    "the time at which the absolute value of the angular velocity is small but not zero. Because\n",
    "of the closeness of these events, we can expect both events to be detected during the same timestep,\n",
    "with the second event triggering twice.\n",
    "\n",
    "Let's begin by defining the two events:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "e88f6283",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define two close non-terminal events.\n",
    "ev0 = hy.nt_event(v, lambda ta, time, d_sgn: print(\"Event 0 triggering at t={}\".format(time)))\n",
    "ev1 = hy.nt_event(v * v - 1e-12,  lambda ta, time, d_sgn: print(\"Event 1 triggering at t={}\".format(time)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d15712eb",
   "metadata": {},
   "source": [
    "This time the events' callbacks just print the event time to screen, without\n",
    "modifying the ``zero_vel_times`` list.\n",
    "\n",
    "We can then reset the integrator, propagate for a few time units and check the screen output:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b5ff7697",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Event 0 triggering at t=0.0\n",
      "Event 1 triggering at t=2.0416669147618175e-06\n",
      "Event 1 triggering at t=1.0036997462725616\n",
      "Event 0 triggering at t=1.003701787940065\n",
      "Event 1 triggering at t=1.0037038296081024\n",
      "Event 1 triggering at t=2.0074015342133102\n",
      "Event 0 triggering at t=2.00740357588013\n",
      "Event 1 triggering at t=2.0074056175472714\n",
      "Event 1 triggering at t=3.0111033221532955\n",
      "Event 0 triggering at t=3.011105363820195\n",
      "Event 1 triggering at t=3.0111074054870994\n",
      "Event 1 triggering at t=4.0148051100933335\n",
      "Event 0 triggering at t=4.01480715176026\n",
      "Event 1 triggering at t=4.014809193427186\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(<taylor_outcome.time_limit: -4294967299>,\n",
       " 0.17033435611316083,\n",
       " 0.17602774916423602,\n",
       " 29,\n",
       " None)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Reset the integrator.\n",
    "ta = hy.taylor_adaptive(((x, v), (v, -9.8 * hy.sin(x))), [-0.05, 0.], nt_events = [ev0, ev1])\n",
    "\n",
    "# Propagate for a few time units.\n",
    "ta.propagate_until(5.)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8517d247",
   "metadata": {},
   "source": [
    "Note how the events are indeed processed in chronological order, and how the event detection system is able to\n",
    "successfully recognize the second event triggering twice in close succession.\n",
    "\n",
    "## Terminal events\n",
    "\n",
    "The fundamental characteristic of terminal events is that, in contrast to non-terminal events,\n",
    "they alter the dynamics and/or the state of the system. A typical example of a terminal event is the\n",
    "[elastic collision](https://en.wikipedia.org/wiki/Elastic_collision) of\n",
    "two rigid bodies, which instantaneously and discontinuously changes the bodies' velocity vectors.\n",
    "Another example is the switching on of a spacecraft engine, which alters the differential\n",
    "equations governing the dynamics of the spacecraft.\n",
    "\n",
    "Terminal events are represented in heyoka.py by the ``t_event`` class. Similarly to\n",
    "the ``nt_event`` class, the construction of a ``t_event`` requires\n",
    "at the very least the expression corresponding to the left-hand side of the event equation.\n",
    "A number of additional optional keyword arguments can be passed to customise the behaviour\n",
    "of a terminal event:\n",
    "\n",
    "- ``callback``: a callback function that will be called when the event triggers. Note that,\n",
    "  for terminal events, the presence of a callback is optional (whereas it is mandatory for\n",
    "  non-terminal events);\n",
    "- ``cooldown``: a floating-point value representing the cooldown time for the terminal event\n",
    "  (see below for an explanation);\n",
    "- ``direction``: a value of the ``event_direction`` enum which, like for non-terminal\n",
    "  events, can be used to specify that the event should be detected only for a specific direction\n",
    "  of the zero crossing.\n",
    "\n",
    "It is important to understand how heyoka.py reacts to terminal events. At every integration timestep, heyoka.py\n",
    "performs event detection for both terminal and non-terminal events. If one or more terminal events\n",
    "are detected, heyoka.py will sort the detected terminal events by time and will select the first\n",
    "terminal event triggering in chronological order (or reverse chronological order when integrating\n",
    "backwards in time). All the other terminal events and all the non-terminal events triggering *after*\n",
    "the first terminal event are discarded. heyoka.py then propagates the state of the system up to the\n",
    "trigger time of the first terminal event, executes the callbacks of the surviving non-terminal events\n",
    "in chronological order and finally executes the callback of the first terminal event (if provided).\n",
    "\n",
    "In order to illustrate the use of terminal events, we will consider a damped pendulum with a small twist:\n",
    "the friction coefficient $\\alpha$ switches discontinuously between 1 and 0 every time the angular\n",
    "velocity $v$ is zero. The ODE system reads:\n",
    "\n",
    "$$\n",
    "\\begin{cases}\n",
    "x^\\prime = v \\\\\n",
    "v^\\prime = - 9.8\\sin x - \\alpha v\n",
    "\\end{cases},\n",
    "$$\n",
    "\n",
    "and the terminal event equation is, again, simply $v = 0$.\n",
    "\n",
    "Let us begin with the definition of the terminal event:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "25b73228",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Clear up zero_vel_times.\n",
    "zero_vel_times.clear()\n",
    "\n",
    "# Callback for the terminal event.\n",
    "def t_cb(ta, mr, d_sgn):\n",
    "    # NOTE: the value of the drag coefficient\n",
    "    # is stored as the first (and only) runtime parameter\n",
    "    # of the integrator.\n",
    "    if ta.pars[0] == 0:\n",
    "        ta.pars[0] = 1\n",
    "    else:\n",
    "        ta.pars[0] = 0\n",
    "\n",
    "    # Append the event time to zero_vel_times.\n",
    "    zero_vel_times.append(ta.time)\n",
    "\n",
    "    # Do not stop the integration.\n",
    "    return True\n",
    "\n",
    "# Define a terminal event that turns air drag on/off\n",
    "# whenever the velocity goes to zero.\n",
    "t_ev = hy.t_event(\n",
    "        # The event equation.\n",
    "        v,\n",
    "        # The callback.\n",
    "        callback = t_cb)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cb7c460f",
   "metadata": {},
   "source": [
    "Like in the case of non-terminal events, we specified as first construction argument\n",
    "the event equation. As second argument we passed a callback function that will be invoked\n",
    "when the event triggers.\n",
    "\n",
    "As you can see from the code snippet, the callback signature for terminal events\n",
    "differs from the signature non-terminal callbacks. Specifically:\n",
    "\n",
    "- the event trigger time is not passed to the callback. This is not necessary\n",
    "  because, when a terminal event triggers, the state of the integrator is propagated\n",
    "  up to the event, and thus the trigger time is the current integrator time\n",
    "  (which can be fetched via ``ta.time``);\n",
    "- there is an additional boolean function argument, here called ``mr``. We will be ignoring\n",
    "  this extra argument for the moment, its meaning will be clarified in the\n",
    "  cooldown section below;\n",
    "- whereas non-terminal event callbacks do not return anything, terminal event callbacks\n",
    "  are required to return ``True`` or ``False``. If the callback returns ``False`` the integration\n",
    "  will always be stopped after the execution of the callback. Otherwise, when using the\n",
    "  ``propagate_*()`` family of functions, the integration will resume after the execution\n",
    "  of the callback.\n",
    "\n",
    "Note that, for the purpose of stopping the integration, an event *without* a callback is considered\n",
    "equivalent to an event whose callback returns ``False``.\n",
    "We thus refer to terminal events without a callback or whose callback returns ``False``\n",
    "as *stopping* terminal events, because their occurrence will prevent the integrator from continuing\n",
    "without user intervention.\n",
    "\n",
    "Like for non-terminal events, the last callback argument is the sign of the time derivative\n",
    "of the event equation at the event trigger time.\n",
    "\n",
    "In this example, within the callback code we alter the value of the drag coefficient $\\alpha$\n",
    "(which is stored within the runtime parameters of the integrator): if $\\alpha$\n",
    "is currently 0, we set it to 1, otherwise we set it to 0.\n",
    "\n",
    "Let us proceed to the construction of the integrator:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "9aa86e4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Construct the damped pendulum integrator.\n",
    "ta = hy.taylor_adaptive([(x, v),\n",
    "                        # NOTE: alpha is represented as\n",
    "                        # the first (and only) runtime\n",
    "                        # parameter: par[0].\n",
    "                        (v, -9.8 * hy.sin(x) - hy.par[0] * v)],\n",
    "                        [0.05, 0.025],\n",
    "                        # The list of terminal events.\n",
    "                        t_events = [t_ev])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52552430",
   "metadata": {},
   "source": [
    "Similarly to the non-terminal events case, the list of terminal events\n",
    "is specified when constructing an integrator via the ``t_events`` keyword argument.\n",
    "\n",
    "If a terminal event triggers within the single-step functions (``step()`` and ``step_backward()``),\n",
    "the outcome of the integration will contain the index of the event that triggered. Let us see a simple example:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "f90d1825",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Event index: 0\n"
     ]
    }
   ],
   "source": [
    "# Propagate step-by-step until the event triggers.\n",
    "oc, h = ta.step()\n",
    "while oc == hy.taylor_outcome.success:\n",
    "    oc, h = ta.step()\n",
    "\n",
    "# Print the outcome to screen.\n",
    "print(\"Event index: {}\".format(int(oc)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "59ef83e2",
   "metadata": {},
   "source": [
    "The screen output confirms that the first (and only) event triggered. For stopping terminal events,\n",
    "the numerical value of the outcome is the opposite of the event index minus one.\n",
    "\n",
    "Because here we used the single step\n",
    "function, even if the event's callback returned ``True`` the integration was stopped in correspondence of the\n",
    "event. Let us now use the ``propagate_grid()`` function instead, so that the integration resumes after the\n",
    "execution of the callback:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2b6d0469",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final time: 10.0\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Construct a time grid from the current time to t=10.\n",
    "t_grid = np.linspace(ta.time, 10, 1000)\n",
    "\n",
    "# Propagate over the time grid.\n",
    "x_hist = ta.propagate_grid(t_grid)[4][:,0]\n",
    "\n",
    "# Display the time evolution for the x variable.\n",
    "plt.plot(t_grid, x_hist)\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"x\")\n",
    "\n",
    "# Put vertical lines in correspondence of\n",
    "# the detected events.\n",
    "for ev_time in zero_vel_times:\n",
    "    plt.axvline(x = ev_time, linestyle='--', color='gray')\n",
    "\n",
    "print(\"Final time: {}\".format(ta.time))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "49c4ea5a",
   "metadata": {},
   "source": [
    "The screen output confirms that indeed the integration continued up to the final time $t = 10$.\n",
    "\n",
    "The plot shows how the event correctly triggered at $v=0$ and how, in the time intervals in which $\\alpha = 1$, the motion of the pendulum was damped by the air drag.\n",
    "\n",
    "### Cooldown\n",
    "\n",
    "One notable complication when restarting an integration that was stopped in correspondence of a terminal event\n",
    "is the risk of immediately re-triggering the same event, which would lead to an endless loop without any progress\n",
    "being made in the integration.\n",
    "\n",
    "In order to avoid this issue, whenever a terminal event occurs the event enters\n",
    "a *cooldown* period. Within the cooldown period, occurrences of the same event are ignored by the event detection\n",
    "system.\n",
    "\n",
    "The length of the cooldown period is, by default, automatically deduced by heyoka.py, following a heuristic\n",
    "that takes into account:\n",
    "\n",
    "* the error tolerance of the integrator,\n",
    "* the derivative of the event equation at the trigger time.\n",
    "\n",
    "The heuristic works best under the assumption that the event equation does not change (much) after the\n",
    "execution of the event's callback. If, for any reason, the automatic deduction heuristic is\n",
    "to be avoided, it is possible to set a custom value for the cooldown.\n",
    "A custom cooldown period can be selected when constructing\n",
    "a terminal event via the ``cooldown`` keyword argument.\n",
    "\n",
    "When a terminal event triggers and enters the cooldown period, the event detection system will also try to detect\n",
    "the occurrence of multiple roots of the event equation within the cooldown period. If such multiple roots are detected,\n",
    "then the ``mr`` boolean parameter in the terminal event callback will be set to ``True``, so that the user\n",
    "has the possibility to handle such occurrence. Note that an ``mr`` value of ``False`` in the callback does not imply\n",
    "that multiple roots do not exist, just that they were not detected.\n",
    "\n",
    "Note that manually modifying the integrator's time or state does **not** automatically reset the cooldown values\n",
    "for terminal events. This could in principle lead to missing terminal events when the integration restarts.\n",
    "For this reason, a method called ``reset_cooldowns()`` is available to clear the cooldown timers of\n",
    "all terminal events.\n",
    "\n",
    "## Limitations and caveats\n",
    "\n",
    "### Badly-conditioned event equations\n",
    "\n",
    "Because heyoka.py's event detection system is based on polynomial root finding techniques, it will experience\n",
    "issues when the Taylor series of the event equations have roots of multiplicity greater than 1. This is usually\n",
    "not a problem in practice, unless the event equations are written in such a way to always generate polynomials\n",
    "with multiple roots.\n",
    "\n",
    "For instance, an event equation such as\n",
    "\n",
    "$$\n",
    "\\left[ g\\left( t, \\boldsymbol{x} \\left( t \\right) \\right) \\right]^2 = 0\n",
    "$$\n",
    "\n",
    "will be troublesome, because both the event equation *and* its time derivative will be zero\n",
    "when the event triggers. This will translate to a Taylor series with a double root in correspondence\n",
    "of the event trigger time, which will lead to a breakdown of the root finding algorithm.\n",
    "This, at best, will result in reduced performance and, at worst, in missing events altogether.\n",
    "Additionally, in case of terminal events the automatically-deduced cooldown value in correspondence of\n",
    "a double root will tend to infinity.\n",
    "\n",
    "As a general rule, users should then avoid defining event equations in which the event trigger times\n",
    "are stationary points.\n",
    "\n",
    "Note that missed events due to badly-conditioned polynomials will likely be flagged by heyoka's logging system.\n",
    "\n",
    "### Event equations and timestepping\n",
    "\n",
    "As explained earlier, the differential equations of the events are added to the ODE system and\n",
    "integrated together with the original equations. Because of this, event equations influence the\n",
    "selection of the adaptive timestep, even if no event is ever detected throughout the integration.\n",
    "\n",
    "For instance, the absolute value of the event equation at the beginning of the timestep is taken\n",
    "into account for the determination of the timestep size in relative error control mode. Thus, if\n",
    "the typical magnitude of the event equation throughout the integration is much larger than the typical\n",
    "magnitude of the state variables, the integration error for the state variables will increase with respect\n",
    "to an integration without event detection.\n",
    "\n",
    "As another example, an event equation which requires small timesteps for accurate numerical propagation\n",
    "(e.g., a highly-stiff equation) will inevitably slow down also the propagation of the ODEs."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
