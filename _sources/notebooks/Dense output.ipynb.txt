{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "0fc6751b",
   "metadata": {},
   "source": [
    "# Dense & continuous output\n",
    "\n",
    "One of the peculiar features of Taylor's method is that it directly provides,\n",
    "via Taylor series, *dense* (or *continuous*) output.\n",
    "That is, the Taylor series built by the integrator at each timestep can be used\n",
    "to compute the solution of the ODE system at *any time* within the timestep\n",
    "(and not only at the endpoint) via polynomial evaluation.\n",
    "\n",
    "Because the construction of the Taylor series is part of the timestepping algorithm,\n",
    "support for dense output comes at essentially no extra\n",
    "cost. Additionally, because the dense output is computed via the\n",
    "Taylor series of the solution of the ODE system, its accuracy\n",
    "is guaranteed to respect the error tolerance set in the integrator.\n",
    "\n",
    "Dense output can be used either from a low-level API, which gives direct access to\n",
    "the coefficients of the Taylor polynomials of the solution within a timestep,\n",
    "or from a higher-level API, which facilitates the common use case of using the coefficients\n",
    "of the Taylor polynomials to compute the continuous extension of the solution.\n",
    "If you are interested only in the latter, you can skip the next sections and jump\n",
    "directly to the continuous output section.\n",
    "\n",
    "In order to illustrate how to use dense output in heyoka.py,\n",
    "we will keep things simple and consider a simple harmonic oscillator:\n",
    "\n",
    "$$\n",
    "   \\begin{cases}\n",
    "   x^\\prime = v \\\\\n",
    "   v^\\prime = -x\n",
    "   \\end{cases},\n",
    "$$\n",
    "\n",
    "with initial conditions\n",
    "\n",
    "$$\n",
    "   \\begin{cases}\n",
    "   x\\left( 0 \\right) = 0 \\\\\n",
    "   v\\left( 0 \\right) = 1\n",
    "   \\end{cases}.\n",
    "$$\n",
    "\n",
    "The analytical solution for this simple ODE system is, of course,\n",
    "\n",
    "$$\n",
    "   \\begin{cases}\n",
    "   x\\left( t \\right) = \\sin\\left(t\\right) \\\\\n",
    "   v\\left( t \\right) = \\cos\\left(t\\right)\n",
    "   \\end{cases}.\n",
    "$$\n",
    "\n",
    "## Dense output for the ``step()`` methods\n",
    "\n",
    "Let's start by setting up the integrator:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "075fd172",
   "metadata": {},
   "outputs": [],
   "source": [
    "import heyoka as hy\n",
    "import numpy as np\n",
    "\n",
    "x, v = hy.make_vars(\"x\", \"v\")\n",
    "\n",
    "ta = hy.taylor_adaptive([(x, v),\n",
    "                         (v, -x)],\n",
    "                        state = [0., 1.])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5aaf26b4",
   "metadata": {},
   "source": [
    "Enabling dense output in heyoka.py is a two-step process.\n",
    "\n",
    "The first step is to invoke one of the ``step()`` methods\n",
    "passing an extra boolean parameter set to ``True``:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ed5a015d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(<taylor_outcome.success: -4294967297>, 1.03425164317259)"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.step(write_tc = True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1676418a",
   "metadata": {},
   "source": [
    "The extra ``write_tc = True`` argument instructs the integrator\n",
    "to record into an internal array the list of Taylor series\n",
    "coefficients that were generated by the timestepping algorithm.\n",
    "We can fetch the list of Taylor coefficients\n",
    "via the ``tc`` read-only property:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "300ac177",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 0.00000000e+00,  1.00000000e+00, -0.00000000e+00,\n",
       "        -1.66666667e-01,  0.00000000e+00,  8.33333333e-03,\n",
       "        -0.00000000e+00, -1.98412698e-04,  0.00000000e+00,\n",
       "         2.75573192e-06, -0.00000000e+00, -2.50521084e-08,\n",
       "         0.00000000e+00,  1.60590438e-10, -0.00000000e+00,\n",
       "        -7.64716373e-13,  0.00000000e+00,  2.81145725e-15,\n",
       "        -0.00000000e+00, -8.22063525e-18,  0.00000000e+00],\n",
       "       [ 1.00000000e+00, -0.00000000e+00, -5.00000000e-01,\n",
       "         0.00000000e+00,  4.16666667e-02, -0.00000000e+00,\n",
       "        -1.38888889e-03,  0.00000000e+00,  2.48015873e-05,\n",
       "        -0.00000000e+00, -2.75573192e-07,  0.00000000e+00,\n",
       "         2.08767570e-09, -0.00000000e+00, -1.14707456e-11,\n",
       "         0.00000000e+00,  4.77947733e-14, -0.00000000e+00,\n",
       "        -1.56192070e-16,  0.00000000e+00,  4.11031762e-19]])"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.tc"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5f5d899b",
   "metadata": {},
   "source": [
    "The Taylor coefficients are stored in a 2D array, where each row refers to a different state variable and the number of columns is the Taylor order of the integrator plus one. Thus, the zero-order coefficients for the $x$ and $v$ variables are, respectively:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "71841158",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0., 1.])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.tc[:, 0]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1f4e187",
   "metadata": {},
   "source": [
    "Indeed, the zero-order Taylor coefficients for the state variables are nothing but\n",
    "the initial conditions at the beginning of the timestep that was just taken.\n",
    "\n",
    "> **NOTE:** This last point is important and needs to be stressed again: the Taylor\n",
    "> coefficients always refer to the **last** step taken and **not** to the next\n",
    "> step that the integrator might take."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e526ea35",
   "metadata": {},
   "source": [
    "We are now ready to ask the integrator to compute the value of the solution at some\n",
    "arbitrary time. Let's pick $t = 0.5$,\n",
    "which is about halfway through the timestep that was just taken:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "86ced14d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.47942554, 0.87758256])"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.update_d_output(t = 0.5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "58bff24f",
   "metadata": {},
   "source": [
    "The ``update_d_output()`` method takes in input an *absolute* time coordinate\n",
    "and returns a reference to an internal array that will contain the state of the system\n",
    "at the specified time coordinate, as computed by the evaluation of the Taylor series.\n",
    "``update_d_output()`` can also be called with a time coordinate relative to the current time\n",
    "by passing ``rel_time = True`` as an additional function argument.\n",
    "\n",
    "The dense output array can be accessed directly via the ``d_output`` property:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4f87b0e7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.47942554, 0.87758256])"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.d_output"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fda73301",
   "metadata": {},
   "source": [
    "Let's now compare the dense output for the $x$ variable to the exact analytical solution for $t \\in \\left[ 0, 1 \\right]$:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "948a6f53",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from matplotlib.pylab import plt\n",
    "plt.rcParams[\"figure.figsize\"] = (12,6)\n",
    "\n",
    "# Construct a time grid from t=0 to t=1.\n",
    "t_grid = np.linspace(0, 1, 100)\n",
    "\n",
    "# Compute the dense output for the x variable\n",
    "# over the time grid.\n",
    "x_d_out = np.array([ta.update_d_output(t)[0] for t in t_grid])\n",
    "\n",
    "# Compare it to the exact solution.\n",
    "plt.plot(t_grid, (x_d_out - np.sin(t_grid)))\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"Absolute error\");"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "19120ed5",
   "metadata": {},
   "source": [
    "As you can see, the dense output matches the exact solution to machine precision.\n",
    "\n",
    "Let's now ask for the dense output at the very end of the timestep that was just taken (i.e., at the current time coordinate), and let's compare it to the current state vector:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "04fda936",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0., 0.])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ta.update_d_output(ta.time) - ta.state"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ccc39a58",
   "metadata": {},
   "source": [
    "That is, as expected, the dense output at the end of the previous timestep\n",
    "matches the current state of the system to machine precision.\n",
    "\n",
    "Before concluding, we need to highlight a couple of caveats regarding the\n",
    "use of dense output.\n",
    "\n",
    "> **NOTE**: first, it is the user's responsibility to ensure that the array of Taylor\n",
    "> coefficients contains up-to-date values. In other words, the user needs to remember\n",
    "> to invoke the ``step()`` methods with the extra boolean argument ``write_tc = True``\n",
    "> before invoking ``update_d_output()``.\n",
    "> Failure to do so will result in ``update_d_output()`` producing incorrect values.\n",
    "\n",
    "> **NOTE**: second, the accuracy of dense output is guaranteed to match the integrator's\n",
    "> accuracy only if the time coordinate falls within the last step taken. Note that heyoka.py will\n",
    "> **not** prevent the invocation of ``update_d_output()`` with time coordinates outside the\n",
    "> guaranteed accuracy range - it is the user's responsibility to be aware\n",
    "> that doing so will produce results whose accuracy does not match the integrator's\n",
    "> error tolerance.\n",
    "\n",
    "The second point can be better appreciated if we try to compute the dense output past the end of the last timestep taken:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "373234c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Construct a time grid from t=1 to t=3.\n",
    "t_grid = np.linspace(1, 3, 100)\n",
    "\n",
    "# Compute the dense output for the x variable\n",
    "# over the time grid.\n",
    "x_d_out = np.array([ta.update_d_output(t)[0] for t in t_grid])\n",
    "\n",
    "# Compare it to the exact solution.\n",
    "plt.semilogy(t_grid, abs((x_d_out - np.sin(t_grid)) / np.sin(t_grid)))\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"Relative error\");"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4c47015f",
   "metadata": {},
   "source": [
    "As you can see, past $t \\sim 1$ the dense output is still accurate for another $\\sim 0.5$ time units, but eventually the error with respect to the exact solution begins to increase steadily."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3fdc856-a40c-48a6-845a-1c2ea2e08a28",
   "metadata": {},
   "source": [
    "## Dense output for the ``propagate_*()`` methods\n",
    "\n",
    "Dense output can be enabled also for the time-limited propagation methods\n",
    "``propagate_for()`` and ``propagate_until()`` via the boolean keyword argument\n",
    "``write_tc``.\n",
    "\n",
    "When ``write_tc`` is set to ``True``, the ``propagate_*()`` methods\n",
    "will internally invoke the ``step()`` methods with the optional boolean\n",
    "flag ``write_tc`` set to ``True``, so that at the end of each timestep the Taylor coefficients\n",
    "will be available. The Taylor coefficients can be used, e.g., inside the\n",
    "optional callback that can be passed to the ``propagate_*()`` methods.\n",
    "\n",
    "Note that ``propagate_grid()`` always unconditionally writes the Taylor coefficients\n",
    "at the end of each timestep, and thus using the ``write_tc`` argument is not necessary.\n",
    "\n",
    "## Continuous output\n",
    "\n",
    "Starting with heyoka.py 0.16,\n",
    "the ``propagate_for()`` and ``propagate_until()`` methods can optionally return a function object\n",
    "providing continuous output in the integration interval. That is, this function object can be used\n",
    "to compute the solution at any time within the time interval covered by ``propagate_for/until()``.\n",
    "\n",
    "Continuous output is activated by passing the ``c_output = True`` keyword option to the ``propagate_for/until()`` methods.\n",
    "Let us see an example:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3f9e30d4-6d00-4a26-bd12-49b3bde7c572",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Reset the integrator state.\n",
    "ta.state[:] = [0, 1]\n",
    "ta.time = 0\n",
    "\n",
    "# Propagate and return the continuous output.\n",
    "c_out = ta.propagate_until(10., c_output=True)[4]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3416bcc-59fb-4aeb-b27e-dbbb3bb25534",
   "metadata": {},
   "source": [
    "The continuous output function object is the fifth element of the tuple returned by ``propagate_for/until()`` (note that if ``c_output`` is set to ``False`` - the default - then the fifth element of the tuple is ``None``).\n",
    "\n",
    "Let us print ``c_out`` to screen:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "876106e8-df1b-4730-a7c3-bad2420e8b3c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Direction : forward\n",
       "Time range: [0, 10)\n",
       "N of steps: 10"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "c_out"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c3d2c49e-cdf1-4503-825f-2b7a749c1557",
   "metadata": {},
   "source": [
    "The screen output informs us that the ``c_out`` object is capable of providing continuous output in\n",
    "the $\\left[0, 10\\right)$ time interval, and that 10 steps were taken during the integration.\n",
    "\n",
    "The call operator of the ``c_out`` object accepts in input either\n",
    "\n",
    "* a single absolute time coordinate, or\n",
    "* a 1D vector of absolute time coordinates.\n",
    "\n",
    "In the first case, the return value will be a 1D NumPy array containing the state vector at the desired time. In the second case, the return value will be a 2D NumPy array in which each row contains the state vector at the corresponding input time.\n",
    "\n",
    "Let us see a couple of examples:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "53fe90c0-22bb-45e2-9310-672ee4ef6f1c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "State vector at t=5: [-0.95892427  0.28366219]\n",
      "\n",
      "State vectors at t=[1,2,3,4,5]:\n",
      "[[ 0.84147098  0.54030231]\n",
      " [ 0.90929743 -0.41614684]\n",
      " [ 0.14112001 -0.9899925 ]\n",
      " [-0.7568025  -0.65364362]\n",
      " [-0.95892427  0.28366219]]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print the state vector at t = 5.\n",
    "print(\"State vector at t=5: {}\\n\".format(c_out(5.)))\n",
    "\n",
    "# Print the state vectors at a few different times.\n",
    "print(\"State vectors at t=[1,2,3,4,5]:\\n{}\\n\".format(c_out([1,2,3,4,5])))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5327bb85-c33f-4c66-9312-29e2fb6b08e2",
   "metadata": {},
   "source": [
    "Let us test the precision of the continuous output over a fine time grid in the $\\left[0, 10\\right]$ time interval:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "529a2e50-bf7d-4369-b167-fd7d35c02462",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Construct a time grid from t=0 to t=10.\n",
    "t_grid = np.linspace(0, 10, 1000)\n",
    "\n",
    "# Compute the continuous output for the x variable\n",
    "# over the time grid.\n",
    "x_c_out = c_out(t_grid)\n",
    "\n",
    "# Compare it to the exact solution.\n",
    "plt.semilogy(t_grid, abs(x_c_out[:,0] - np.sin(t_grid)))\n",
    "plt.xlabel(\"Time\")\n",
    "plt.ylabel(\"Absolute error\");"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f542616-d8b5-4474-8611-35c04b6f7203",
   "metadata": {},
   "source": [
    "As we can see, the continuous output agrees with the analytical solution to machine precision.\n",
    "\n",
    "Continuous output is somewhat similar to ``propagate_grid()``, in the sense that both allow to compute the value of the solution at arbitrary time points. ``propagate_grid()`` is computationally more efficient, but it requires to specify up-front the list of times at which the solution should be computed. Continuous output, on the other hand, is not bound to a predetermined time grid, and it can thus be helpful if time coordinates of interest can be identified only after the solution has been computed.\n",
    "\n",
    "Before concluding, we need to highlight a couple of caveats regarding the\n",
    "use of continuous output.\n",
    "\n",
    "> **NOTE**: the ``continuous_output`` function object stores internally the time\n",
    "> coordinate and Taylor coefficients at the end of each step taken during the integration interval.\n",
    "> This means that the memory usage of a ``continuous_output`` object scales linearly\n",
    "> with the number of timesteps taken during the integration interval. Thus, for a sufficiently\n",
    "> long integration interval, the ``continuous_output`` object might end up exhausting the available memory.\n",
    "\n",
    "> **NOTE**: like for dense output, the accuracy of ``continuous_output`` is guaranteed to\n",
    "> match the integrator’s accuracy only if the time coordinate falls within the integration interval.\n",
    "> Note that heyoka.py will not prevent the use of a ``continuous_output`` object outside the\n",
    "> guaranteed accuracy range - it is the user’s responsibility to be aware that doing so will\n",
    "> produce results whose accuracy does not match the integrator’s error tolerance.\n",
    "\n",
    "Note that, like the other main classes in heyoka.py, ``continuous_output`` supports [serialisation](<./pickling.ipynb>)."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
